<form [formGroup]="form" (ngSubmit)="onSubmit()">
  @for (field of fields; track $index) {
    <label [for]="field.name">{{ field.label }}</label>
    @switch (field.tipoCampo) {
      @case ('input') {
        <input [type]="field.type" 
               [formControlName]="field.name"
               [attr.placeholder]="field.attributes?.['placeholder'] || field.name"
        >
      }
      @case ('select') {
        <select [formControlName]="field.name"
        >
          @for (option of field.options; track $index) {
            <option [value]="option.value">
              {{ option.label }}
            </option>
          }
        </select>
      }
      @case ('textarea') {
        <br>
        <textarea [formControlName]="field.name"
          [attr.placeholder]="field.attributes?.['placeholder'] || field.name"
          [attr.rows]="field.attributes?.['rows'] || 10"
          [attr.cols]="field.attributes?.['cols'] || 10"
        ></textarea>
      }
    }
    <br>

    @if (form.get(field.name)?.invalid && form.get(field.name)?.touched) {
      <div>
        <small>
          @if (form.get(field.name)?.errors?.['required']) {Este campo es obligatorio}
          @if (form.get(field.name)?.errors?.['maxlength']) {El texto es demasiado largo}
          @if (form.get(field.name)?.errors?.['minlength']) {El texto es demasiado corto}
          @if (form.get(field.name)?.errors?.['email']) {Por favor, introduce un email correcto}
        </small>
      </div>
    }
  }
  <button>Guardar</button>
</form>
